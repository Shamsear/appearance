{% extends 'base.html' %}

{% block title %}Player Detection App{% endblock %}

{% block content %}
<div class="container my-4">
    <div class="jumbotron">
        <h1 class="display-4">Player Detection App</h1>
        <p class="lead">Upload a video to extract player appearances from FIFA/EA FC player ratings screens.</p>
        <hr class="my-4">
        <p>This tool helps you track which players appeared in a match by analyzing player ratings screens.</p>
    </div>
    
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h3 class="card-title">Upload Video</h3>
        </div>
        <div class="card-body">
            <form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data">
                <div class="form-group mb-3">
                    <label for="file">Select video file (MP4, AVI, MOV, MKV):</label>
                    <input type="file" class="form-control" id="file" name="file" accept=".mp4,.avi,.mov,.mkv">
                </div>
                
                <div class="form-group mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="use_default_excel" value="1" id="use_default_excel" checked>
                        <label class="form-check-label" for="use_default_excel">
                            Use default Excel file (APPEARANCE.xlsx in root directory)
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="use_default_excel" value="0" id="upload_excel">
                        <label class="form-check-label" for="upload_excel">
                            Upload Excel file
                        </label>
                    </div>
                </div>
                
                <div class="form-group mb-3" id="excel_upload_section" style="display:none;">
                    <label for="excel_file">Select Excel file:</label>
                    <input type="file" class="form-control" id="excel_file" name="excel_file" accept=".xlsx">
                </div>
                
                <div class="card mb-3">
                    <div class="card-header bg-secondary text-white">
                        Manual Team Selection (Optional)
                    </div>
                    <div class="card-body">
                        <p>You can manually select the teams or let the app detect them from the video filename.</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="home_team">Home Team:</label>
                                    <select class="form-control" id="home_team" name="home_team">
                                        <option value="">Auto-detect from filename</option>
                                        {% for team in teams %}
                                            <option value="{{ team }}">{{ team }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label for="away_team">Away Team:</label>
                                    <select class="form-control" id="away_team" name="away_team">
                                        <option value="">Auto-detect from filename</option>
                                        {% for team in teams %}
                                            <option value="{{ team }}">{{ team }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="match_day">Match Day (1-5):</label>
                            <input type="number" class="form-control" id="match_day" name="match_day" min="1" max="5" placeholder="Auto-detect from filename">
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary">Upload and Process</button>
            </form>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    <h3 class="card-title">Batch Processing</h3>
                </div>
                <div class="card-body">
                    <p>Need to process multiple videos at once? Try our batch processing option.</p>
                    <a href="{{ url_for('batch_upload') }}" class="btn btn-success">Go to Batch Processing</a>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    <h3 class="card-title">View Results</h3>
                </div>
                <div class="card-body">
                    <p>View previously processed results and team statistics.</p>
                    <a href="{{ url_for('teams') }}" class="btn btn-info">View Team Stats</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const useDefaultExcel = document.getElementById('use_default_excel');
        const uploadExcel = document.getElementById('upload_excel');
        const excelUploadSection = document.getElementById('excel_upload_section');
        
        function toggleExcelUpload() {
            if (useDefaultExcel.checked) {
                excelUploadSection.style.display = 'none';
            } else {
                excelUploadSection.style.display = 'block';
            }
        }
        
        useDefaultExcel.addEventListener('change', toggleExcelUpload);
        uploadExcel.addEventListener('change', toggleExcelUpload);
        
        // Initial toggle
        toggleExcelUpload();
    });
</script>
{% endblock %} 